---
title: "Registered Report"
author: "Marqus Odisho"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#install.packages('ggplot2')
#install.packages('lme4')
#install.packages('lmerTest')
#install.packages('MuMIn')
#install.packages('MASS')
#install.packages('dplyr')
#install.packages('tidyr')
#install.packages('car')
#install.packages('pbkrtest')
#install.packages('pscl')
library(ggplot2)
library(lme4)
library(lmerTest)
library(MuMIn)
library(MASS)
library(dplyr)
library(tidyr)
library(car)
library(pbkrtest)
library(pscl)
```

### Description

Code looks to simulate assortative mating between two species to form hybrids. This assortative mating will be based on q scores which can range from 0 (which indicates species 1) to 1 (which indicates species 2) and intermediate values which indicate hybrids of the two. The code will simulate two types of assortative mating, the strict definition which means that individuals will want to mate with someone with an identical q score and the extreme phenotype definition which is where individuals will want to mate with someone with either a higher or lower q score than them. The code will simulate individual maternal and paternal datasets and then pair them up based on either of the two assortative mating definitions previously mentioned. The aformentioned pairing will be visualized in a scatterplot to show the mating patterns. Then hybrids will be generated based on those previous mating patterns that will be a blend of the q scores of both parents. The q scores of the hybrids will be plotted to show how different assortative mating patterns influence hybrid zone outcomes. 

```{r Assortative Mating - Strict Definition}
# Set a seed for reproducibility
set.seed(123)

# Create two datasets, q_maternal and q_paternal, each with 1000 data points following a beta distribution where the most common q scores are 1 or 0 but there are hybrids
q_maternal <- rbeta(1000, 0.3, 0.3)
q_paternal <- rbeta(1000, 0.3, 0.3)

# Display simulated dataset distribution before sampling
hist(q_paternal)
hist(q_maternal)

# Create a new dataset, sampled_q_maternal, by sampling 500 q scores without replacement from the q_maternal dataset
sampled_q_maternal <- sample(q_maternal, 500, replace=FALSE)

# Create a new variable, sampled_q_paternal, by sampling 500 q scores from the q_paternal dataset
# Use the ifelse() function to set the probability of selecting a q score from q_paternal based on the corresponding q score in sampled_q_maternal
sampled_q_paternal <- sapply(sampled_q_maternal, function(x) {
  if (x >= 0.5) {
    sample(q_paternal[q_paternal >= 0.5], 1, prob = rep(0.9 / length(q_paternal[q_paternal >= 0.5]), length(q_paternal[q_paternal >= 0.5])))
  } else {
    sample(q_paternal[q_paternal < 0.5], 1, prob = rep(0.1 / length(q_paternal[q_paternal < 0.5]), length(q_paternal[q_paternal < 0.5])))
  }
})

# Create a new dataframe, `q_scores_df`, by combining sampled_q_maternal and sampled_q_paternal
q_scores_df <- data.frame(sampled_q_maternal, sampled_q_paternal)

# Plot a scatterplot of sampled_q_paternal versus sampled_q_maternal to visualize the relationship between the two variables where mating is based on having a similar q score
plot(sampled_q_maternal, sampled_q_paternal, xlab="Sampled Maternal q scores", ylab="Sampled Paternal q scores", main="Scatterplot of Maternal vs Paternal q scores")
```

```{r Assortative Mating - Extreme Phenotype Preference}
# Set a seed for reproducibility
set.seed(123)

# Create two datasets, `q_maternal` and `q_paternal`, each with 1000 data points following a beta distribution
q_maternal <- rbeta(1000, 0.3, 0.3)
q_paternal <- rbeta(1000, 0.3, 0.3)

# Display simulated dataset distribution before sampling
hist(q_paternal)
hist(q_maternal)

# Create a new dataset, sampled_q_maternal, by sampling 500 q scores without replacement from the q_maternal dataset
sampled_q_maternal <- sample(q_maternal, 500, replace=FALSE)

# Create a new variable, sampled_q_paternal, by sampling 500 q scores from the q_paternal dataset
# Use the ifelse() function to set the probability of selecting a q score from q_paternal based on the corresponding q score in sampled_q_maternal
sampled_q_paternal <- sapply(sampled_q_maternal, function(x) {
  if (x <= 0.5) {
    # If the maternal q score is less than or equal to 0.5, sample from the lower half of the paternal q scores with higher probability
    sample(q_paternal[q_paternal <= 0.5], 1, prob = ifelse(q_paternal[q_paternal <= 0.5] <= 0.25, 0.9, 0.1))
  } else {
    # If the maternal q score is greater than 0.5, sample from the upper half of the paternal q scores with higher probability
    sample(q_paternal[q_paternal > 0.5], 1, prob = ifelse(q_paternal[q_paternal > 0.5] >= 0.75, 0.9, 0.1))
  }
})

# Create a new dataframe, q_scores_df, by combining sampled_q_maternal and sampled_q_paternal
q_scores_df <- data.frame(sampled_q_maternal, sampled_q_paternal)

# Plot a scatterplot of sampled_q_paternal versus sampled_q_maternal to visualize the relationship between the two variables where they are paired based on extreme q score preference
plot(sampled_q_maternal, sampled_q_paternal, xlab="Sampled Maternal q scores", ylab="Sampled Paternal q scores", main="Scatterplot of Maternal vs Paternal q scores")
```

